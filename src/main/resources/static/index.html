<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8">
  <title>üî• –î–µ–Ω—å 7 ‚Äî –í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ –∞–≥–µ–Ω—Ç–æ–≤ (Solver ‚Üí Reviewer)</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    :root { --bd:#e5e7eb; --fg:#111827; --mut:#6b7280; --bg:#ffffff; --acc:#0b6; }
    * { box-sizing: border-box; }
    body { margin: 0; background: var(--bg); color: var(--fg); font: 16px/1.4 system-ui, -apple-system, Segoe UI, Roboto, sans-serif; }
    .wrap { max-width: 1100px; margin: 32px auto; padding: 0 16px; }
    h1 { margin: 0 0 8px; font-size: 22px; }
    .hint { color: var(--mut); margin: 0 0 12px; }
    form { display: grid; grid-template-columns: 1fr auto; gap: 8px; margin: 12px 0 16px; }
    input[type=text] { padding: 12px; border: 1px solid var(--bd); border-radius: 10px; }
    button { padding: 12px 16px; border: 0; background: var(--acc); color: #fff; border-radius: 10px; cursor: pointer; }
    button:disabled { opacity: .6; cursor: not-allowed; }
    .grid { display:grid; grid-template-columns: 1fr 1fr; gap: 12px; }
    .card { border: 1px solid var(--bd); border-radius: 12px; padding: 12px; background: #fff; min-height: 220px; display:flex; flex-direction:column; }
    .head { display:flex; align-items:center; justify-content:space-between; gap:8px; margin-bottom: 8px; }
    .title { font-weight: 600; }
    .meta { color: var(--mut); font-size: 12px; }
    .log { border: 1px solid var(--bd); border-radius: 10px; padding: 10px; background: #fafafa; flex:1; white-space: pre-wrap; overflow:auto; }
    .pending { opacity: .7; }
    .examples { display:flex; gap:8px; flex-wrap:wrap; margin: 8px 0; }
    .ex { background:#f3f4f6; border:1px solid var(--bd); border-radius:8px; padding:6px 10px; font-size:12px; cursor:pointer; }
    .ex:hover { background: var(--acc); color:#fff; border-color: var(--acc); }
  </style>
</head>
<body>
<div class="wrap">
  <h1>üî• –î–µ–Ω—å 7 ‚Äî –í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ –∞–≥–µ–Ω—Ç–æ–≤</h1>
  <p class="hint">–ê–≥–µ–Ω—Ç 1 —Ä–µ—à–∞–µ—Ç, –ê–≥–µ–Ω—Ç 2 –ø—Ä–æ–≤–µ—Ä—è–µ—Ç. –í–≤–µ–¥–∏—Ç–µ –∑–∞–¥–∞—á—É –∏ —Å–º–æ—Ç—Ä–∏—Ç–µ –¥–≤–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞.</p>

  <div class="examples">
    <button class="ex" data-q="–†–µ—à–∏ —É—Ä–∞–≤–Ω–µ–Ω–∏–µ: 2x + 6 = 14. –î–∞–π –æ—Ç–≤–µ—Ç –∫–∞–∫ –∑–Ω–∞—á–µ–Ω–∏–µ x.">–£—Ä–∞–≤–Ω–µ–Ω–∏–µ</button>
    <button class="ex" data-q="–£ –ü–µ—Ç–∏ –±—ã–ª–æ 12 —è–±–ª–æ–∫, –æ–Ω –¥–∞–ª –í–∞–Ω–µ 5, –∞ –ú–∞—à–∞ –≤–µ—Ä–Ω—É–ª–∞ 3. –°–∫–æ–ª—å–∫–æ –æ—Å—Ç–∞–ª–æ—Å—å —É –ü–µ—Ç–∏?">–Ø–±–ª–æ–∫–∏</button>
    <button class="ex" data-q="–°—Ä–∞–≤–Ω–∏ –¥–≤–∞ —á–∏—Å–ª–∞: 27√ó14 –∏ 30√ó12‚àí6. –ß—Ç–æ –±–æ–ª—å—à–µ? –î–∞–π —Ç–æ–ª—å–∫–æ –æ—Ç–≤–µ—Ç.">–°—Ä–∞–≤–Ω–µ–Ω–∏–µ</button>
  </div>

  <form id="form" autocomplete="off">
    <input id="task" type="text" placeholder="–í–≤–µ–¥–∏—Ç–µ –∑–∞–¥–∞—á—É... –Ω–∞–ø—Ä–∏–º–µ—Ä: –†–µ—à–∏ —É—Ä–∞–≤–Ω–µ–Ω–∏–µ: 2x + 6 = 14" />
    <button id="send" type="submit">–ó–∞–ø—É—Å—Ç–∏—Ç—å</button>
  </form>

  <div class="grid">
    <div class="card" id="c1">
      <div class="head">
        <div class="title">–ê–≥–µ–Ω—Ç 1 ‚Äî –†–µ—à–µ–Ω–∏–µ</div>
        <div class="meta" id="m1">–≤—Ä–µ–º—è: ‚Äì ms</div>
      </div>
      <div class="log" id="l1">‚Äì</div>
    </div>
    <div class="card" id="c2">
      <div class="head">
        <div class="title">–ê–≥–µ–Ω—Ç 2 ‚Äî –ü—Ä–æ–≤–µ—Ä–∫–∞</div>
        <div class="meta" id="m2">–≤—Ä–µ–º—è: ‚Äì ms</div>
      </div>
      <div class="log" id="l2">‚Äì</div>
    </div>
  </div>
</div>

<script>
  const $form = document.getElementById('form');
  const $task = document.getElementById('task');
  const $send = document.getElementById('send');
  const $l1 = document.getElementById('l1');
  const $l2 = document.getElementById('l2');
  const $m1 = document.getElementById('m1');
  const $m2 = document.getElementById('m2');
  const $ex = document.querySelectorAll('.ex');

  $ex.forEach(btn => btn.addEventListener('click', () => {
    $task.value = btn.dataset.q;
    $task.focus();
  }));

  function setPending(on) {
    document.getElementById('c1').classList.toggle('pending', on);
    document.getElementById('c2').classList.toggle('pending', on);
    if (on) { $l1.textContent = '–ê–≥–µ–Ω—Ç 1 –¥—É–º–∞–µ—Ç‚Ä¶'; $l2.textContent = '–ê–≥–µ–Ω—Ç 2 –∂–¥—ë—Ç —á–µ—Ä–Ω–æ–≤–∏–∫‚Ä¶'; }
  }

  async function runPipeline() {
    const task = $task.value.trim();
    if (!task) return;
    $send.disabled = true;
    setPending(true);
    try {
      const res = await fetch('/pipeline', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ task })
      });
      const data = await res.json();
      if (!res.ok) throw new Error(data?.error || ('HTTP ' + res.status));
      $l1.textContent = data.agent1?.text || '(–ø—É—Å—Ç–æ)';
      $l2.textContent = data.agent2?.text || '(–ø—É—Å—Ç–æ)';
      $m1.textContent = '–≤—Ä–µ–º—è: ' + (data.agent1?.latencyMs ?? '‚Äì') + ' ms';
      $m2.textContent = '–≤—Ä–µ–º—è: ' + (data.agent2?.latencyMs ?? '‚Äì') + ' ms';
    } catch (e) {
      $l1.textContent = '–û—à–∏–±–∫–∞: ' + (e?.message || e);
      $l2.textContent = '–û—à–∏–±–∫–∞';
    } finally {
      $send.disabled = false;
      setPending(false);
      $task.focus();
    }
  }

  $form.addEventListener('submit', (e) => {
    e.preventDefault();
    runPipeline();
  });
</script>
</body>
</html>
